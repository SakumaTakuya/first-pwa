# ウォークスルー - データのエクスポート/インポート機能

データのバックアップと復元を行うためのエクスポート/インポート機能を実装しました。
これにより、ユーザーは自分のデータをJSONファイルとして保存し、必要に応じて復元することができます。また、マイグレーション前のバックアップとしても利用可能です。

## 変更点

### ロジック層
- **`src/lib/backup.ts`**:
    - `exportData()`: `localStorage` (Zustandの状態) と `IndexedDB` (Dexieのデータ) を収集し、JSONオブジェクトとして返します。
    - `importData()`: バックアップデータを読み込み、`localStorage` と `IndexedDB` に復元します。復元後はページをリロードして変更を反映します。
    - `downloadBackup()`: エクスポートしたデータをJSONファイルとしてダウンロードさせます。
- **`src/lib/utils.ts`**:
    - `reloadPage()`: テスト容易性のためにページリロード処理を分離しました。
    - `cn()`: UIコンポーネントで使用するクラス名結合ユーティリティを復元しました。
- **`src/lib/db.ts`**:
    - バックアップ機能が `exercises` テーブルを扱えるように、スキーマ定義を更新しました。

### UI層
- **`src/components/settings-modal.tsx`**:
    - データ管理用の設定モーダルを作成しました。
    - 「データをエクスポート」ボタンと「データをインポート」ボタンを配置しました。
- **`src/app/page.tsx`**:
    - ヘッダーに設定アイコン（歯車マーク）を追加し、クリックすると設定モーダルが開くようにしました。

### テスト
- **`src/lib/backup.test.ts`**:
    - `exportData` と `importData` のロジックを検証する単体テストを作成しました。
    - `jest` を導入し、`npm run test` で実行できるようにしました。

## 検証結果

### 自動テスト
- `npm run build`: **合格**
- `npm run lint`: **合格**
- `npm run test`: **合格**

### 手動検証手順
1.  **設定モーダルを開く**: ホーム画面右上の歯車アイコンをクリックします。
2.  **エクスポート**: 「データをエクスポート」をクリックし、JSONファイルがダウンロードされることを確認します。
3.  **インポート**:
    - (オプション) アプリのデータを変更または削除します。
    - 「データをインポート」をクリックし、先ほどダウンロードしたJSONファイルを選択します。
    - 確認ダイアログで「OK」をクリックします。
    - ページがリロードされ、データが復元されていることを確認します。
